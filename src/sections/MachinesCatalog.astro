---
import SectionLayout from "@/layouts/SectionLayout.astro";
import Link from "@/components/ui/Link.astro";
import type { Section } from "@/interfaces/section.interface";
import { getMainImage } from "@/utils/get-main-image";

interface Props {
  section: Section;
}

const { section } = Astro.props as Props;
---

<SectionLayout aria-labelledby="machines-catalog-title">
  <header class="text-center mb-12">
    <h2 class="title text-secondary! mb-4">
      {section.title}
    </h2>
    <p class="description max-w-3xl mx-auto">
      {section.description}
    </p>
  </header>

  <!-- Lista de equipos -->
  <div class="animate-fadeInUp slider-machines swiper max-w-full">
    <!-- Tarjeta 1 -->

    <div class="swiper-wrapper py-6!">
      <!-- Tarjeta 2 -->

      {
        section.machines?.map((machine) => (
          <article class="swiper-slide h-full bg-white rounded-2xl shadow-md hover:shadow-lg transition-transform duration-300  flex flex-col items-center text-center hover:scale-105">
            <figure>
              <img
                src={getMainImage(machine)}
                alt={`Imagen de ${machine.name}`}
                class="mx-auto h-48 object-contain mb-4"
              />
              <figcaption class="sr-only">{machine.name}</figcaption>
            </figure>
            <h3 class="text-lg font-semibold text-secondary mb-2">
              {machine.name}
            </h3>
            <p class="text-gray-600 text-sm mb-6 px-4">{machine.description}</p>
            {(machine.link || machine.text_button) && (
              <footer class="mt-auto pb-6">
                <Link
                  link={machine.link}
                  textButton={machine.text_button}
                  class="text-white!"
                  variant="button"
                />
              </footer>
            )}
          </article>
        ))
      }
    </div>

    <div class="swiper-button-prev"></div>
    <div class="swiper-button-next"></div>
  </div>

  <script>
    import Swiper from "swiper/bundle";
    import "swiper/css/bundle";

    new Swiper(".slider-machines", {
      slidesPerView: 4,
      spaceBetween: 30,
      centerInsufficientSlides: true,
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      breakpoints: {
        0: {
          slidesPerView: 1,
          spaceBetween: 20,
        },
        480: {
          slidesPerView: 2,
          spaceBetween: 30,
        },

        768: {
          slidesPerView: 3,
          spaceBetween: 40,
        },
        1024: {
          slidesPerView: 4,
          spaceBetween: 50,
        },
      },
    });
  </script>
</SectionLayout>
